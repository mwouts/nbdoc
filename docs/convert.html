---

title: Convert Notebooks To Markdown


keywords: fastai
sidebar: home_sidebar

summary: "Utilities that help you go from .ipynb -> .md"
description: "Utilities that help you go from .ipynb -> .md"
nb_path: "nbs/convert.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/convert.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nb2md" class="doc_header"><code>nb2md</code><a href="https://github.com/outerbounds/nbdoc/tree/master/nbdoc/convert.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nb2md</code>(<strong><code>fname</code></strong>:<code>Union</code>[<code>str</code>, <code>Path</code>], <strong><code>exp</code></strong>:<code>Exporter</code>)</p>
</blockquote>
<p>Convert a notebook in <code>fname</code> to a markdown file.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use <a href="/nbdoc/convert.html#nb2md"><code>nb2md</code></a> to convert a notebook to a markdown file with an <code>Exporter</code>.  Below, we use the exporter given to us by <code>nbdoc.mdx.get_mdx_exporter</code> and use that to create a markdown file from a notebook.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;test_files/example_input.ipynb&#39;</span><span class="p">)</span>
<span class="n">_test_dest</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;test_files/example_input.md&#39;</span><span class="p">)</span>
<span class="n">_test_dest</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">_test_dest</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="c1"># make sure the markdown file doesn&#39;t exist</span>

<span class="n">nb2md</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">_test_fname</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">get_mdx_exporter</span><span class="p">())</span> <span class="c1"># create the markdown file</span>
<span class="k">assert</span> <span class="n">_test_dest</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="c1"># make sure the markdown file does exist</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">_test_dest</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>converting: test_files/example_input.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat <span class="o">{</span>_test_dest<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>---
title: my hello page title
description: my hello page description
hide_table_of_contents: true
---
## This is a test notebook

This is a shell command:


```bash
echo hello
```

    hello


We are writing a python script to disk:


```py title=&#34;myflow.py&#34;
from metaflow import FlowSpec, step

class MyFlow(FlowSpec):
    
    @step
    def start(self):
        print(&#39;this is the start&#39;)
        self.next(self.end)
    
    @step
    def end(self):
        print(&#39;this is the end&#39;)

if __name__ == &#39;__main__&#39;:
    MyFlow()
```

Another shell command where we run a flow:


```bash
python myflow.py run
```

    2022-02-15 14:11:09.224 [1644963069213536/start/1 (pid 46840)] Task is starting.
    2022-02-15 14:11:09.858 [1644963069213536/start/1 (pid 46840)] this is the start
    2022-02-15 14:11:09.929 [1644963069213536/start/1 (pid 46840)] Task finished successfully.
    ...

This is a normal python cell:




    2



The next cell has a cell tag of `remove_input`, so you should only see the output of the cell:

    hello, you should not see the print statement that produced me

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">parallel_nb2md</span><span class="p">(</span><span class="n">basedir</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span><span class="nb">str</span><span class="p">],</span> <span class="n">exp</span><span class="p">:</span><span class="n">Exporter</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pause</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s2">&quot;Convert all notebooks in `dir` to markdown files.&quot;</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">nbglob</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">force_all</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">n_workers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">force_all</span><span class="p">:</span>
        <span class="c1"># only rebuild modified files</span>
        <span class="n">files</span><span class="p">,</span><span class="n">_files</span> <span class="o">=</span> <span class="p">[],</span><span class="n">files</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">_files</span><span class="p">:</span>
            <span class="n">fname_out</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.md&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fname_out</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fname_out</span><span class="p">):</span>
                <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No notebooks were modified.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;win32&quot;</span><span class="p">:</span> <span class="n">n_workers</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">passed</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span><span class="n">nb2md</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="n">n_workers</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span>  <span class="n">pause</span><span class="o">=</span><span class="n">pause</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">passed</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Conversion failed on the following:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span><span class="n">files</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use <code>parallel_nb2md</code> to recursively convert a directory of notebooks to markdown files.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_test_nbs</span> <span class="o">=</span>  <span class="n">nbglob</span><span class="p">(</span><span class="s1">&#39;test_files/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parallel_nb2md</span><span class="p">(</span><span class="s1">&#39;test_files/&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="n">get_mdx_exporter</span><span class="p">(),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>converting: test_files/run_flow_showstep.ipynb
converting: test_files/hello_world.ipynb
converting: test_files/run_flow.ipynb
converting: test_files/example_input.ipynb
converting: test_files/writefile.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_test_nbs</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.md&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="si">}</span><span class="s1"> does not exist.&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The modified times of notebooks are introspected such notebooks that haven't changed after markdown files have been created will not be converted:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parallel_nb2md</span><span class="p">(</span><span class="s1">&#39;test_files/&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="n">get_mdx_exporter</span><span class="p">(),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>No notebooks were modified.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, you can set <code>force_all</code> = <code>True</code> to force notebooks to convert:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parallel_nb2md</span><span class="p">(</span><span class="s1">&#39;test_files/&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="n">get_mdx_exporter</span><span class="p">(),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>converting: test_files/run_flow_showstep.ipynb
converting: test_files/hello_world.ipynb
converting: test_files/run_flow.ipynb
converting: test_files/example_input.ipynb
converting: test_files/writefile.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nbdoc_build" class="doc_header"><code>nbdoc_build</code><a href="https://github.com/outerbounds/nbdoc/tree/master/nbdoc/convert.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nbdoc_build</code>(<strong><code>srcdir</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>force_all</code></strong>:<code>bool_arg</code>=<em><code>False</code></em>, <strong><code>n_workers</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>pause</code></strong>:<code>float</code>=<em><code>0.5</code></em>)</p>
</blockquote>
<p>Build the documentation by converting notebooks matching <code>fname</code> to html</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>srcdir</code></strong></td>
<td><code>str</code></td>
<td><code>None</code></td>
<td>A directory of notebooks to convert to docs recursively, can also be a filename.</td>
</tr>
<tr>
<td><strong><code>force_all</code></strong></td>
<td><code>bool_arg</code></td>
<td><code>False</code></td>
<td>Rebuild even notebooks that havent changed</td>
</tr>
<tr>
<td><strong><code>n_workers</code></strong></td>
<td><code>int</code></td>
<td><code>None</code></td>
<td>Number of workers to use</td>
</tr>
<tr>
<td><strong><code>pause</code></strong></td>
<td><code>float</code></td>
<td><code>0.5</code></td>
<td>Pause time (in secs) between notebooks to avoid race conditions</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

